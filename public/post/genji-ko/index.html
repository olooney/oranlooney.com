<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Art and Mathematics of Genji-Kō - OranLooney.com</title>
  <meta property="og:title" content="The Art and Mathematics of Genji-Kō - OranLooney.com" />
  <meta name="twitter:title" content="The Art and Mathematics of Genji-Kō - OranLooney.com" />
  <meta name="description" content="You might think there&rsquo;s unlikely to be any interesting mathematics arising from incense appreciation, but that&rsquo;s only because you&rsquo;re unfamiliar with the peculiar character of Muromachi (室町) era (circa 1300-1500) Japanese nobles.
There has never been a group of people in any time or place who were so keen to display their sophistication and refinement. It wouldn&rsquo;t do to merely put out a few sticks of incense - no, you would have to prove that your taste was more exquisite, your judgement more refined, your etiquette more oblique.">
  <meta property="og:description" content="You might think there&rsquo;s unlikely to be any interesting mathematics arising from incense appreciation, but that&rsquo;s only because you&rsquo;re unfamiliar with the peculiar character of Muromachi (室町) era (circa 1300-1500) Japanese nobles.
There has never been a group of people in any time or place who were so keen to display their sophistication and refinement. It wouldn&rsquo;t do to merely put out a few sticks of incense - no, you would have to prove that your taste was more exquisite, your judgement more refined, your etiquette more oblique.">
  <meta name="twitter:description" content="You might think there&rsquo;s unlikely to be any interesting mathematics arising from incense appreciation, but that&rsquo;s only because you&rsquo;re unfamiliar with the peculiar character of …">
  <meta name="author" content="Oran Looney"/>

  <meta name="generator" content="Hugo 0.42.1" />
  <link rel="stylesheet" href="/css/style.css" media="all" />
  <link rel="stylesheet" href="/css/syntax.css" media="all" />
  <link rel="stylesheet" href="/css/custom.css" media="all" />

  <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous" async></script>

  <script defer src="https://use.fontawesome.com/releases/v5.15.4/js/all.js" integrity="sha384-rOA1PnstxnOBLzCLMcre8ybwbTmemjzdNlILg8O7z1lUkLXozs4DHonlDtnE7fpc" crossorigin="anonymous" async></script>
 
</head>

<body>
<header class="site-header">
  <nav class="site-navi">
    <a href="/" class="site-title">OWL</a>
    <ul class="site-navi-items">
      <li class="site-navi-item">
        <a href="/search/" title="Site Search"><i class="fa fa-search"></i></a>
      </li>
      <li class="site-navi-item">
        <a href="/tags/" title="Article Tags"><i class="fa fa-tag"></i></a>
      </li>
      <li class="site-navi-item">
        <a href="/archives/" title="Article Archives"><i class="fa fa-archive"></i></a>
      </li>
      <li class="site-navi-item">
        <a href="/quotes/" title="Favorite Quotes"><i class="fas fa-quote-right"></i></a>
      </li>
      <li class="site-navi-item">
        <a href="/about/" title="About Me"><i class="fa fa-info-circle"></i></a>
      </li>
    </ul>
    
  <ul class="author-social">
    <li><a href="//honeycode.tumblr.com/" target="_blank" title="Honeycode Microblog">
      <svg class="svg-inline--fa fa-w-12" aria-hidden="true" data-prefix="fab" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="20 50 350 450" data-fa-i2svg="">
<path fill="currentColor" d="M193 97l86.6 50v100l-86.6 50l-86.6 -50v-100zM285 255l86.6 50v100l-86.6 50l-86.6 -50v-100zM100 255l86.6 50v100l-86.6 50l-86.6 -50v-100z"></path>
</svg>
    </a></li>
    <li><a href="//linkedin.com/in/oran-looney" target="_blank" title="LinkedIn"><i class="fab fa-linkedin"></i></a></li>
    <li><a href="https://github.com/olooney" target="_blank"  title="github"><i class="fab fa-github"></i></a></li>
    <li><a href="https://stackoverflow.com/users/273231/olooney" target="_blank" title="StackOverflow"><i class="fab fa-stack-overflow"></i></a></li>
    <li><a href="https://stats.stackexchange.com/users/48250/olooney" target="_blank" title="CrossValidated"><i class="fa fa-flask"></i></a></li>
  </ul>

  </nav>
</header>


  <div class="main" role="main">
    <article class="article">
      <img src="/post/genji-ko_files/lead.jpg" class="article-image" />
      
      <h1 class="article-title">The Art and Mathematics of Genji-Kō</h1>
      
      <hr class="article-title-bottom">
      <ul class="article-meta">
        <li class="article-meta-author">
            by <a href="/about/">Oran Looney</a>
        </li>
        <li class="article-meta-date"><time>October 30, 2024</time></li>
        <li class="article-meta-tags">
          <a href="/tags/python/">
            <i class="fas fa-tag"></i>
            Python
          </a>&nbsp;
        </li>
        <li class="article-meta-tags">
          <a href="/tags/visualization/">
            <i class="fas fa-tag"></i>
            Visualization
          </a>&nbsp;
        </li>
        <li class="article-meta-tags">
          <a href="/tags/history/">
            <i class="fas fa-tag"></i>
            History
          </a>&nbsp;
        </li>
      </ul>
      
<aside class="toc">
  <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#notation">Notation</a></li>
<li><a href="#etymology">Etymology</a></li>
<li><a href="#culture">Culture</a></li>
<li><a href="#patterns">Patterns</a></li>
<li><a href="#order">Order</a></li>
<li><a href="#final-result">Final Result</a></li>
<li><a href="#mathematics">Mathematics</a></li>
<li><a href="#appendix-a-full-chart">Appendix A: Full Chart</a></li>
<li><a href="#appendix-b-full-table">Appendix B: Full Table</a></li>
</ul></li>
</ul>
</nav>
</aside>
      

<p>You might think there&rsquo;s unlikely to be any interesting mathematics arising from
incense appreciation, but that&rsquo;s only because you&rsquo;re unfamiliar with the
peculiar character of Muromachi (室町) era (circa 1300-1500) Japanese nobles.</p>

<p>There has never been a group of people in any time or place who were so keen to
display their sophistication and refinement. It wouldn&rsquo;t do to merely put out a
few sticks of incense - no, you would have to prove that your taste was more
exquisite, your judgement more refined, your etiquette more oblique. You could
of course merely invite some other nobles over for an incense appreciation
party, make a few cutting but plausibly deniable remarks about a rival, maybe
drop a few lines of poetry linking the incense to the current season. But if
you were really on the ball you&rsquo;d be looking for a way to simultaneously
humiliate your rivals, flirt with your love interest, and impress people in a
position of power. They didn&rsquo;t just perfect cultured refinement - they
weaponized it.</p>

<p>Only under such conditions could something like genji-kō (源氏香) arise. It is
a parlor game played with incense - just one of many similar games inside the
broader umbrella of kōdō (香道), the traditional art of incense appreciation.</p>

<p>What sets genji-kō apart is its extreme difficulty - where another game might
have contestants write down their guesses for three separate incenses and score
a point for each correct guess, genji-kō asks contestants to smell five
separate samples, then determine which of the five are the same. All five might
be the same, or all five might be different, or (and this is where it gets
interesting) they might be in groups of two or three or four. For example, the
correct solution might be that the first and fourth are the same, the second
and fifth are the same, and the third in a group by itself. Or any other
possible combination of groupings.</p>

<p>Contestants score a single point if they correctly group all five incenses;
otherwise they score nothing. A typical game would have five rounds over the
course of the evening, with an overall winner declared at the end.</p>

<p>Obviously contestants would need some kind of notation to record their answers
in a concise, unambiguous, and easy to read way, and it is this notation - and
the art and mathematics that arose from it - that this article is about.</p>

<h2 id="notation">Notation</h2>

<p>Every pattern has exactly five vertical lines, representing the five possible incenses.
To show that two or more incenses are part of the same group, you draw a horizontal
line connecting the top of every vertical line in that group. To avoid confusion
when there are two or more groups, you draw these horizontal lines at different
heights, shortening the vertical lines as needed:</p>

<p><img src="/post/genji-ko_files/examples.png"></p>

<p>There are a few nuances to the notation worth mentioning. If two groups don&rsquo;t
overlap, there is no need draw them at different heights (top center.) If one
group is &ldquo;contained&rdquo; inside another, the inner group is drawn at the lower height (top right, bottom left)
so that it appears nested inside the other. And in some cases, say when the
groups are $\{\{1, 3\}, \{2, 5\},$ $\{4\}\}$ (bottom center), it is impossible to avoid
an intersection but we understand that the groups are still distinct because
the horizontal connecting lines are at different heights.</p>

<p>Genji-Kō features as a plot point in <a href="https://www.imdb.com/title/tt2076558/">episode 8 of the experimental horror
anime Mononoke</a>, where it is suggested that players used blocks to
record their solutions. While this might be true - the episodes description of
genji-Kō is otherwise grounded and well-researched - I haven&rsquo;t seen any other
references to this; everything else I&rsquo;ve seen suggests the game was played with
ink and paper.</p>

<p><img src="/post/genji-ko_files/blocks.png"></p>

<h2 id="etymology">Etymology</h2>

<p>Genji-kō, by the way, is named after the titular Genji of the Heian (平安) era
literary classic <a href="https://en.wikipedia.org/wiki/The_Tale_of_Genji">The Tale of Genji</a>. There are two connections. First, in
one chapter of the book Genji hosts an incense appreciation party. Second,
since there are 52 possible patterns and 54 chapters of the book, each pattern
is traditionally associated with - and named after - each chapter (except for
the first and last chapters, which are omitted.) Every educated person of the
Muromachi era would be intimately familiar with <em>The Tale of Genji</em> and would
know the themes, season, and characters associated with each chapter. by heart,
giving each pattern a literary resonance.</p>

<p>Genji-kō refers to the game, but the game is so closely tied to the patterns
that it can refer to them as well. I used Google to count the number of search
results for different ways of referring to the patterns themselves.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Kanji</th>
      <th style="text-align: left">Romaji</th>
      <th style="text-align: left">English Translation</th>
      <th style="text-align: left">Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>源氏紋</td>
      <td>Genjimon</td>
      <td>Genji Crest</td>
      <td>844,000</td>
    </tr>
    <tr>
      <td>源氏香図</td>
      <td>Genji-kōzu</td>
      <td>Genji-kō Diagram</td>
      <td>686,000</td>
    </tr>
    <tr>
      <td>源氏香の模様</td>
      <td>Genji-kō no moyō</td>
      <td>Genji-kō Pattern</td>
      <td>400,000</td>
    </tr>
    <tr>
      <td>源氏香模様</td>
      <td>Genji-kō moyō</td>
      <td>Genji-kō Design</td>
      <td>479,000</td>
    </tr>
    <tr>
      <td>源氏香文様</td>
      <td>Genji-kō monyō</td>
      <td>Genji-kō Motif</td>
      <td>129,000</td>
    </tr>
  </tbody>
</table>

<p>Based on these results, I&rsquo;ll refer to the patterns themselves as genji-mon
when I want to explicitly refer to the visual pattern.</p>

<p>TODO</p>

<h2 id="culture">Culture</h2>

<p>Compared to other traditional arts from the same era such as tea ceremony or
flower arranging, kōdō is not particular popular or well-known even in Japan;
nevertheless it is <a href="https://www.youtube.com/watch?v=wpDb5LhvvSM">still played</a> even to this day.</p>

<p>However, its cultural influence extends beyond the few who actually play the
game - the patterns show up fairly often as a motif in contemporary Japanese
graphic design:</p>

<p><img src="/post/genji-ko_files/genjiko_colorful.jpg"></p>

<p>It&rsquo;s especially popular on traditional handcrafted goods, such as kimino:</p>

<p><img src="/post/genji-ko_files/kimono.jpg"></p>

<p>Cheaper fabrics simply print the same genji-mon repeatedly, but the mark of
high-quality genji-Kō fabric is to use a variety of genji-mon so that the
pattern never quite repeats:</p>

<p><img src="/post/genji-ko_files/fabric.jpg"></p>

<p>They are often found on good related to incense or kōdō in some way, such
as this incense box:</p>

<p><img src="/post/genji-ko_files/incense_box.jpg"></p>

<!-- <img src="/post/genji-ko_files/incense_set.jpg"> -->

<p>or this incense holder:
<img src="/post/genji-ko_files/incense_holder.jpg"></p>

<p><a href="https://en.wikipedia.org/wiki/Kunisada">Utagawa Kunisada</a>, circa 1843, painted a  wall scoll for each chapter
of the Tale of Genji and included the associated genji-mon on every one:</p>

<p><img src="/post/genji-ko_files/yugiri_wall_scroll.jpg"></p>

<h2 id="patterns">Patterns</h2>

<p>Knuth writes about it:
<img src="/post/genji-ko_files/combanatorics_ancient_and_modern_page.png"></p>

<pre><code class="language-python">def partitions(s: Set[int]) -&gt; Iterator[List[Set[int]]]:
    &quot;&quot;&quot;Yield all partitions of a set as they are generated.&quot;&quot;&quot;
    if not s:
        yield []
        return
    first = next(iter(s))
    rest = s - {first}
    for partition in partitions(rest):
        yield [{first}] + partition
        for i in range(len(partition)):
            new_partition = (
                partition[:i] + 
                [partition[i] | {first}] + partition[i+1:]
            )
            yield new_partition
</code></pre>

<p>Optimal genji-kō layouts for each partition:</p>

<pre><code class="language-python">def optimal_genjiko_for_partition(
    partition: List[Set[int]]
) -&gt; List[Tuple[float, Set[int]]]:
    &quot;&quot;&quot;
    Given a partition, find the optimal genji-kō layout by minimizing a cost
    function.

    I was originally hoping to get to 100% algorithmic generation, but this
    simple rule captures all but 4 of layouts, and the remaining 4 cannot be
    expressed in any rule which is shorter and simpler than just simply listing
    the 4 special cases.
    &quot;&quot;&quot;
    best_cost = math.inf
    best_genjiko = None
    HEIGHTS = [1.0, 0.8, 0.6]
    
    # Generate all possible combinations of heights
    for height_combo in itertools.product(HEIGHTS, repeat=len(partition)):
        genjiko_candidate = [
            (height, group) 
            for height, group 
            in zip(height_combo, partition)
        ]
        
        # Skip invalid configurations
        if not validate_genjiko(genjiko_candidate):
            continue
        
        # Encourage larger heights
        cost = -sum(height for height, _ in genjiko_candidate)  
        
        for height1, group1 in genjiko_candidate:
            for height2, group2 in genjiko_candidate:
                # Large penalty for higher inner group height
                if is_nested_within(group1, group2) and height1 &gt; height2:
                    cost += 1
        
        # keep track of the best solution so far
        if cost &lt; best_cost:
            best_cost = cost
            best_genjiko = genjiko_candidate

    return best_genjiko
</code></pre>

<p>Here&rsquo;s what we get if always use the algorithmically calculated &ldquo;optimal&rdquo;
layout and simply put them in the order returned by <code>partitions()</code>:</p>

<p><img src="/post/genji-ko_files/algorithmic_genjiko.png"></p>

<p>Good, but not perfect. The order is largely wrong, and there are four
genji-kō (the ones rendered in red) where our concept of &ldquo;optimal&rdquo; has
failed to reproduce the traditional design.</p>

<h2 id="order">Order</h2>

<p>Knuth <a href="https://www.amazon.com/Combinatorics-Ancient-Modern-Robin-Wilson/dp/0198739052">mentions</a> that the genji-kō patterns &ldquo;were not arranged in any
particularly logical order&rdquo; and I&rsquo;m inclined to agree. I tried several
variations of the above <code>partition()</code> function hoping to find one where the
traditional order would just fall out naturally, but it never did. A close
inspection of the table makes it clear that this was never going to happen:
there&rsquo;s an overall trend from many separate groups to fewer groups, but there
are just too many cases where the order is arbitrary.</p>

<p>I found a ton of references that put the genji-kō in a different order, and
even some that tried to stretch it to 54 using some kind of duplication or
introducing irregular patterns. However, the association between the 52
patterns and chapter titles for chapters 2-53 of the <em>Tale of Genji</em> seem
water tight and consistent. Also, the order of those chapters is mostly
consistent across sources (there is some disagreement about the order of the
later chapters, and one chapter which survives only as a title or perhaps was
intentionally elided as a delicate way to elude to a character&rsquo;s death) so
I&rsquo;ve put my genji-kō in chapter order.</p>

<h2 id="final-result">Final Result</h2>

<p>I spent some time trying to find some elegant heuristic that would nudge
the layout algorithm to produce those four without breaking any of the others,
but the rules were more complex than simply listing the special cases (and
none of them correctly handled Yuguri, which I&rsquo;ll discuss below.)</p>

<p>The four special cases are:</p>

<pre><code class="language-python">    # Suma: {1, 3, 4} should be lower than {2, 5}
    df.at[10, 'Genjiko'] = [(0.8, {1, 3, 4}), (1.0, {2, 5})]
    
    # Hatsune: {1, 3} should be lower than {2, 4}
    df.at[21, 'Genjiko'] = [(0.8, {1, 3}), (1.0, {2, 4}), (1.0, {5})]
    
    # Yuguri: {1, 4} should be lower than {3, 5}, and {2} even lower.
    df.at[37, 'Genjiko'] = [(0.8, {1, 4}), (0.6, {2}), (1.0, {3, 5})]
    
    # Nioumiya: {1, 2, 4} should be lower than {3, 5}
    df.at[40, 'Genjiko'] = [(0.8, {1, 2, 4}), (1.0, {3, 5})]
</code></pre>

<p>With these corrections, and using the <em>Tale of Genji</em> chapter order.</p>

<p><img src="/post/genji-ko_files/genjiko.png"></p>

<p>Of the four exceptions, three are obvious improvements but the fourth, Yugiri,
seems to actively violate the basic rules around nesting and creates a
three-level structure when two would have sufficed.</p>

<p><img src="/post/genji-ko_files/yuguri_diff.png"></p>

<p>I&rsquo;m not about to stand in the way of 900 years of tradition, nor am I about to
argue with the aesthetic sensibilities of Utagawa Kunisada, so we&rsquo;ll use the
traditional version.</p>

<h2 id="mathematics">Mathematics</h2>

<p>The connection between genji-kō and mathematics becomes apparent if we ask
ourselves, &ldquo;Why are there exactly 52 genji-kō patterns? How can we be sure
there aren&rsquo;t more?&rdquo;</p>

<p>Two:
<img src="/post/genji-ko_files/counting_partitions2.png"></p>

<p>Since each group of the partition must contain at least one element, it&rsquo;s
obvious that there can be at most two groups by the <a href="https://en.wikipedia.org/wiki/Pigeonhole_principle">pigeonhole principle</a>.
Thus, there are either zero, one or two groups. Zero doesn&rsquo;t work because
it doesn&rsquo;t cover the set. One does work, and there&rsquo;s obviously only one way to
do it. Suppose there&rsquo;s two groups. At least one of the groups must contain 1.
The other must contain at least one element, but it can&rsquo;t contain 1, therefore
it must contain 1. Since these two groups already cover the set, this is the
full partition. Since we were able to prove the structure of the partition
starting from only the definition of a partition and the fact the set had two
elements, all partitions of a set of two elements must have this structure;
therefore this partition is unique.</p>

<p>For three, things start to get interesting. We need a principle by which we
can divide possible partitions into groups and be assured,</p>

<p>a) that we never count a partition twice
b) that we count every partition.</p>

<p>The trick is to &ldquo;pin&rdquo; one of the elements. Since it&rsquo;s arbitrary, we&rsquo;ll
select element 1, represented by the left vertical bar in a genji-kō pattern.
Exactly one of groups <em>must</em> contain element 1; we&rsquo;ll call this the &ldquo;first&rdquo;
group. This group can any size from 1 to N. Suppose it has size n. Then there
are &ldquo;N-1 choose n&rdquo; possible ways to select the first group. However, whichever
way we pick, there will be N-n elements &ldquo;left over&rdquo; that we must partition.</p>

<p>There&rsquo;s only one way to for the first group to contain only a single element:
if it consists of the first group and no other. However, there are two elements
left over. We already know there are exactly two ways to partition of a set
of two elements, so there must be two partitions of a group of three elements
where the first group is of size one.</p>

<p>What if the first group is of size two? Well, then we have to pick the position
of the other element, and our choices are 2 or 3. Regardless of what we pick,
there will always be one element left over, which can only be partitioned one way.</p>

<p>Finally, if the first group is of size three, there are no elements left over.</p>

<p>Thus we have 1*2 + 2*1 + 1 = 5 ways to partition a set of three elements.</p>

<p>Three:
<img src="/post/genji-ko_files/counting_partitions3.png"></p>

<p>Let&rsquo;s do that for a set of four elements. The first group is of size 1, 2, 3, or 4.</p>

<p>There&rsquo;s only one way to choose a first group of size one, and there are three elements left over,
which we showed above can be partitioned five different ways.</p>

<p>For a first group of size two, we have a choice of three possible elements for other
element of the first group. Regardless of which we pick, we&rsquo;ll have two left
over, and we know there are two ways to partition a set of two elements. Thus
there are 3*2 = 6 partitions where the first group is size two.</p>

<p>There are three ways to pick a first group of size three, because we are essentially
picking which of {2, 3, 4} to leave out. Regardless of how we pick, there is one
element left over, which can only be partitioned one way.</p>

<p>Finally, there is only one way to pick a first group of size four, and with no
elements left over, this gives us only one way to partition the set.</p>

<p>So the total number of ways to partition a set of size 4 is 1*5 + 3*2 + 3*1 + 1</p>

<p>Four:
<img src="/post/genji-ko_files/counting_partitions4.png"></p>

<p>Let&rsquo;s ask ourselves exactly what we&rsquo;re counting, anyway. Each pattern divides
the five incenses into a number of distinct groups. Each of incense belongs
to one and only one group, and every incense belongs to at least one group.
Within each group, there&rsquo;s no particular <em>order</em> to the incenses that belong
to that group - an incense either belongs to a group or it doesn&rsquo;t, it isn&rsquo;t
the first or last of a group. Equally, there&rsquo;s no particular order to the
groups themselves - putting incense 1, 2, 3 into the first group and 4 and 5
into the other is the same as putting 4 and 5 in the first group and 1, 2, 3
and into the second.</p>

<p>In mathematical language, an object which is a collection of other objects
in no particular order so that only membership matters is called a <em>set</em>. Let&rsquo;s
model our problem by starting with a set of five distinct elements that we&rsquo;ll
call $I$ after &ldquo;incense:&rdquo;</p>

<p>\[
    I = \{ 1, 2, 3, 4, 5 \}
\]</p>

<p>Each group of a genji-kō solution is a <em>subset</em> of $I$. Furthermore, since the
genji-kō pattern consists of subsets of $I$ in no particular order, we can
model it as a set too - a set containing other sets.</p>

<p>For example, we could write the 9th genji-kō Sakaki (賢木) as</p>

<p>\[
    G_9 = \{ \{1, 2, 3\}, \{4, 5\} \}
\]</p>

<p>More generally, each genji-kō is given as</p>

<p>\[
    G = \{ S_1, S_2, \dots, S_k \}
\]
where each $S_i$ is a subset of $I$:</p>

<p>\[
    \forall i, S_ \neq \emptyset \land S_i  \subseteq I
\]</p>

<p>Furthermore, we require that no two groups overlap:</p>

<p>\[
    \forall x, y \in G, \, x \neq y \implies x \cap y = \emptyset
\]</p>

<p>and all the groups unioned together covers $I$:</p>

<p>\[
    \bigcup_{S \in G} S = I
\]</p>

<p>This particular structure as a name: it&rsquo;s called a <em>partition</em> of $I$. The
combinatorics of partitions is well-known, so we could just look the formulas
up. But let&rsquo;s see if we can continue our analysis.</p>

<p>We know that partitions of $I$ exist, by construction. For example, we could
put each incense in its own group: $\{ \{1\},\{2\}, \{3\}, \{4\}, \{5\} \}$
or lump them into one big group: $\{ 1, 2, 3, 4, 5\}$. The task is to count
them in a more systematic way.</p>

<p>Here, as is often the case in mathematics, the problem is made easier by abstracting it.
Instead of focusing on sets of five elements, let&rsquo;s ask how we can count to partitions
of any set consisting of a finite number of distinct elements. Let&rsquo;s give it a
name: for reasons that will become clear in a moment,  we&rsquo;ll call the number of
partitions of a set of $k$ distinct elements $B_k$.</p>

<p>The first couple are
easy: it&rsquo;s easy to see that the only way to partition an empty set is $\{\}$, and
the only way to partition a set with one element $\{a\}$ is $\{ \{a\} \}$.
If you&rsquo;re not sure why, refer to the above definition of a partition, particularly
the part where we require that the subsets be non-empty, and try to convince yourself
this is true.</p>

<p>\[
    B_0 = 1
\]</p>

<p>and</p>

<p>\[
    B_1 = 1
\]</p>

<p>Returning to the general case of $B_k$ for $k&gt;1$, we know that our partition
is going to have at least one group in it, so let&rsquo;s focus on that first group
for a second, and ignore any other groups for now. How many ways are there
of selecting just that first group?</p>

<p>Well, it depends on how big that first group is. It&rsquo;s non-empty, so it must be greater than
one, and of course it must be less than k. So we have $1 \ge |S_1| \ge k$.</p>

<p>Again,</p>

<p>\[
    B_{n+1} = \sum_{k=0}^n \binom{n}{k} B_k
\]</p>

<h2 id="appendix-a-full-chart">Appendix A: Full Chart</h2>

<p>Genji-kō are often rendered with very narrow negative space, resulting
in a very pleasing effect:</p>

<p><img src="/post/genji-ko_files/genjiko_dense.png"></p>

<h2 id="appendix-b-full-table">Appendix B: Full Table</h2>

<p>The full table in HTML format, so you can copy-and-paste the Kanji. The Genji-mon column table uses
the <a href="https://www.illllli.com/font/symbol/genjiko/">genjiko TTF font available from illllli.com</a>.</p>

<div class="genjiko-wrapper">
    <style>
        html .article table.genjiko-table td {
            font-size: 100%;
            line-height: 1;
        }
        html .article table.genjiko-table th {
            font-size: 100%;
        }
       html .article table.genjiko-table td.genjiko-chapter {
        text-align: center;
       }
       html .article table.genjiko-table td.genjiko-kanji {
            font-size: 125%;
            text-align: center;
        }
        html .article table.genjiko-table td.genjiko-icon {
            font-size: 200%;
            font-family: 'GenjiKo', sans-serif;
            text-align: center;
            padding: 0px;
            margin: 0px;
        }
        html .article table.genjiko-table td..genjiko-partition {
            text-align: center;
        }
        @font-face {
            font-family: 'GenjiKo';
            src: url('/post/genji-ko_files/genjiko.ttf') format('truetype');
        }
    </style>
    <table class="genjiko-table">
        <thead>
            <tr>
                <th>Chapter</th>
                <th>Kanji</th>
                <th style="text-align: left;">Romaji</th>
                <th style="text-align: left;">English</th>
                <th style="text-align: left;">Partition</th>
                <th>Genji-mon</th>
            </tr>
        </thead>
        <tbody>
            
            <tr>
                <td class="genjiko-chapter">2</td>
                <td class="genjiko-kanji">帚木</td>
                <td class="genjiko-romaji">Hōkigi</td>
                <td class="genjiko-english">The Broom-Tree</td>
                <td class="genjiko-partition">{1}, {2}, {3}, {4}, {5}</td>
                <td class="genjiko-icon">B</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">3</td>
                <td class="genjiko-kanji">空蝉</td>
                <td class="genjiko-romaji">Utsusemi</td>
                <td class="genjiko-english">Utsusemi</td>
                <td class="genjiko-partition">{1}, {2}, {3}, {4, 5}</td>
                <td class="genjiko-icon">C</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">4</td>
                <td class="genjiko-kanji">夕顔</td>
                <td class="genjiko-romaji">Yūgao</td>
                <td class="genjiko-english">Yugao</td>
                <td class="genjiko-partition">{1}, {2}, {3, 4}, {5}</td>
                <td class="genjiko-icon">D</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">5</td>
                <td class="genjiko-kanji">若紫</td>
                <td class="genjiko-romaji">Wakamurasaki</td>
                <td class="genjiko-english">Murasaki</td>
                <td class="genjiko-partition">{1}, {2, 3}, {4, 5}</td>
                <td class="genjiko-icon">E</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">6</td>
                <td class="genjiko-kanji">末摘花</td>
                <td class="genjiko-romaji">Suetsumuhana</td>
                <td class="genjiko-english">The Saffron-Flower</td>
                <td class="genjiko-partition">{1, 2, 3, 4}, {5}</td>
                <td class="genjiko-icon">F</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">7</td>
                <td class="genjiko-kanji">紅葉賀</td>
                <td class="genjiko-romaji">Momijinoga</td>
                <td class="genjiko-english">The Festival of Red Leaves</td>
                <td class="genjiko-partition">{1}, {2, 3, 5}, {4}</td>
                <td class="genjiko-icon">G</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">8</td>
                <td class="genjiko-kanji">花宴</td>
                <td class="genjiko-romaji">Hana no en</td>
                <td class="genjiko-english">The Flower Feast</td>
                <td class="genjiko-partition">{1}, {2}, {3, 5}, {4}</td>
                <td class="genjiko-icon">H</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">9</td>
                <td class="genjiko-kanji">葵</td>
                <td class="genjiko-romaji">Aoi</td>
                <td class="genjiko-english">Aoi</td>
                <td class="genjiko-partition">{1, 2}, {3}, {4}, {5}</td>
                <td class="genjiko-icon">I</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">10</td>
                <td class="genjiko-kanji">賢木</td>
                <td class="genjiko-romaji">Sakaki</td>
                <td class="genjiko-english">The Sacred Tree</td>
                <td class="genjiko-partition">{1, 2, 3}, {4, 5}</td>
                <td class="genjiko-icon">J</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">11</td>
                <td class="genjiko-kanji">花散里</td>
                <td class="genjiko-romaji">Hana chiru sato</td>
                <td class="genjiko-english">The Village of Falling Flowers</td>
                <td class="genjiko-partition">{1}, {2, 4}, {3, 5}</td>
                <td class="genjiko-icon">K</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">12</td>
                <td class="genjiko-kanji">須磨</td>
                <td class="genjiko-romaji">Suma</td>
                <td class="genjiko-english">Exile at Suma</td>
                <td class="genjiko-partition">{1, 3, 4}, {2, 5}</td>
                <td class="genjiko-icon">L</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">13</td>
                <td class="genjiko-kanji">明石</td>
                <td class="genjiko-romaji">Akashi</td>
                <td class="genjiko-english">Akashi</td>
                <td class="genjiko-partition">{1}, {2, 3}, {4}, {5}</td>
                <td class="genjiko-icon">M</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">14</td>
                <td class="genjiko-kanji">澪標</td>
                <td class="genjiko-romaji">Miotsukushi</td>
                <td class="genjiko-english">The Flood Gauge</td>
                <td class="genjiko-partition">{1}, {2, 4, 5}, {3}</td>
                <td class="genjiko-icon">N</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">15</td>
                <td class="genjiko-kanji">蓬生</td>
                <td class="genjiko-romaji">Yomogiu</td>
                <td class="genjiko-english">The Palace in the Tangled Woods</td>
                <td class="genjiko-partition">{1, 2, 3}, {4}, {5}</td>
                <td class="genjiko-icon">O</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">16</td>
                <td class="genjiko-kanji">関屋</td>
                <td class="genjiko-romaji">Sekiya</td>
                <td class="genjiko-english">A Meeting at the Frontier</td>
                <td class="genjiko-partition">{1}, {2, 3, 4}, {5}</td>
                <td class="genjiko-icon">P</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">17</td>
                <td class="genjiko-kanji">絵合</td>
                <td class="genjiko-romaji">Eawase</td>
                <td class="genjiko-english">The Picture Competition</td>
                <td class="genjiko-partition">{1, 3}, {2, 5}, {4}</td>
                <td class="genjiko-icon">Q</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">18</td>
                <td class="genjiko-kanji">松風</td>
                <td class="genjiko-romaji">Matsukaze</td>
                <td class="genjiko-english">The Wind in the Pine-Trees</td>
                <td class="genjiko-partition">{1, 2}, {3, 4}, {5}</td>
                <td class="genjiko-icon">R</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">19</td>
                <td class="genjiko-kanji">薄雲</td>
                <td class="genjiko-romaji">Usugumo</td>
                <td class="genjiko-english">A Wreath of Cloud</td>
                <td class="genjiko-partition">{1}, {2, 3, 4, 5}</td>
                <td class="genjiko-icon">S</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">20</td>
                <td class="genjiko-kanji">朝顔</td>
                <td class="genjiko-romaji">Asagao</td>
                <td class="genjiko-english">Asagao</td>
                <td class="genjiko-partition">{1, 3, 4}, {2}, {5}</td>
                <td class="genjiko-icon">T</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">21</td>
                <td class="genjiko-kanji">乙女</td>
                <td class="genjiko-romaji">Otome</td>
                <td class="genjiko-english">The Maiden</td>
                <td class="genjiko-partition">{1, 3}, {2}, {4}, {5}</td>
                <td class="genjiko-icon">U</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">22</td>
                <td class="genjiko-kanji">玉鬘</td>
                <td class="genjiko-romaji">Tamakazura</td>
                <td class="genjiko-english">Tamakatsura</td>
                <td class="genjiko-partition">{1, 2}, {3, 4, 5}</td>
                <td class="genjiko-icon">V</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">23</td>
                <td class="genjiko-kanji">初音</td>
                <td class="genjiko-romaji">Hatsune</td>
                <td class="genjiko-english">The First Song of the Year</td>
                <td class="genjiko-partition">{1, 3}, {2, 4}, {5}</td>
                <td class="genjiko-icon">W</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">24</td>
                <td class="genjiko-kanji">胡蝶</td>
                <td class="genjiko-romaji">Kochō</td>
                <td class="genjiko-english">The Butterflies</td>
                <td class="genjiko-partition">{1, 4}, {2, 3, 5}</td>
                <td class="genjiko-icon">X</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">25</td>
                <td class="genjiko-kanji">蛍</td>
                <td class="genjiko-romaji">Hotaru</td>
                <td class="genjiko-english">The Glow-Worm</td>
                <td class="genjiko-partition">{1, 2, 4}, {3}, {5}</td>
                <td class="genjiko-icon">Y</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">26</td>
                <td class="genjiko-kanji">常夏</td>
                <td class="genjiko-romaji">Tokonatsu</td>
                <td class="genjiko-english">A Bed of Carnations</td>
                <td class="genjiko-partition">{1}, {2}, {3, 4, 5}</td>
                <td class="genjiko-icon">Z</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">27</td>
                <td class="genjiko-kanji">篝火</td>
                <td class="genjiko-romaji">Kagaribi</td>
                <td class="genjiko-english">The Flares</td>
                <td class="genjiko-partition">{1}, {2, 4}, {3}, {5}</td>
                <td class="genjiko-icon">a</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">28</td>
                <td class="genjiko-kanji">野分</td>
                <td class="genjiko-romaji">Nowaki</td>
                <td class="genjiko-english">The Typhoon</td>
                <td class="genjiko-partition">{1, 2}, {3}, {4, 5}</td>
                <td class="genjiko-icon">b</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">29</td>
                <td class="genjiko-kanji">御幸</td>
                <td class="genjiko-romaji">Miyuki</td>
                <td class="genjiko-english">The Royal Visit</td>
                <td class="genjiko-partition">{1, 3}, {2, 4, 5}</td>
                <td class="genjiko-icon">c</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">30</td>
                <td class="genjiko-kanji">藤袴</td>
                <td class="genjiko-romaji">Fujibakama</td>
                <td class="genjiko-english">Blue Trousers</td>
                <td class="genjiko-partition">{1, 4}, {2}, {3}, {5}</td>
                <td class="genjiko-icon">d</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">31</td>
                <td class="genjiko-kanji">真木柱</td>
                <td class="genjiko-romaji">Makibashira</td>
                <td class="genjiko-english">Makibashira</td>
                <td class="genjiko-partition">{1, 5}, {2, 4}, {3}</td>
                <td class="genjiko-icon">e</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">32</td>
                <td class="genjiko-kanji">梅枝</td>
                <td class="genjiko-romaji">Umegae</td>
                <td class="genjiko-english">The Spray of Plum-Blossom</td>
                <td class="genjiko-partition">{1, 2, 3, 5}, {4}</td>
                <td class="genjiko-icon">f</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">33</td>
                <td class="genjiko-kanji">藤裏葉</td>
                <td class="genjiko-romaji">Fuji no uraba</td>
                <td class="genjiko-english">Fuji no Uraba</td>
                <td class="genjiko-partition">{1}, {2, 5}, {3, 4}</td>
                <td class="genjiko-icon">g</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">34</td>
                <td class="genjiko-kanji">若菜上</td>
                <td class="genjiko-romaji">Wakana jō</td>
                <td class="genjiko-english">Wakana, Part I</td>
                <td class="genjiko-partition">{1, 2, 5}, {3, 4}</td>
                <td class="genjiko-icon">h</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">35</td>
                <td class="genjiko-kanji">若菜下</td>
                <td class="genjiko-romaji">Wakana ge</td>
                <td class="genjiko-english">Wakana, Part II</td>
                <td class="genjiko-partition">{1, 3}, {2}, {4, 5}</td>
                <td class="genjiko-icon">i</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">36</td>
                <td class="genjiko-kanji">柏木</td>
                <td class="genjiko-romaji">Kashiwagi</td>
                <td class="genjiko-english">Kashiwagi</td>
                <td class="genjiko-partition">{1, 3, 5}, {2}, {4}</td>
                <td class="genjiko-icon">j</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">37</td>
                <td class="genjiko-kanji">横笛</td>
                <td class="genjiko-romaji">Yokobue</td>
                <td class="genjiko-english">The Flute</td>
                <td class="genjiko-partition">{1, 4, 5}, {2}, {3}</td>
                <td class="genjiko-icon">k</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">38</td>
                <td class="genjiko-kanji">鈴虫</td>
                <td class="genjiko-romaji">Suzumushi</td>
                <td class="genjiko-english">The Bell Cricket</td>
                <td class="genjiko-partition">{1, 5}, {2}, {3, 4}</td>
                <td class="genjiko-icon">l</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">39</td>
                <td class="genjiko-kanji">夕霧</td>
                <td class="genjiko-romaji">Yūgiri</td>
                <td class="genjiko-english">Yugiri</td>
                <td class="genjiko-partition">{1, 4}, {2}, {3, 5}</td>
                <td class="genjiko-icon">m</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">40</td>
                <td class="genjiko-kanji">御法</td>
                <td class="genjiko-romaji">Minori</td>
                <td class="genjiko-english">The Law</td>
                <td class="genjiko-partition">{1, 4}, {2, 5}, {3}</td>
                <td class="genjiko-icon">n</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">41</td>
                <td class="genjiko-kanji">幻</td>
                <td class="genjiko-romaji">Maboroshi</td>
                <td class="genjiko-english">Mirage</td>
                <td class="genjiko-partition">{1, 5}, {2}, {3}, {4}</td>
                <td class="genjiko-icon">o</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">42</td>
                <td class="genjiko-kanji">匂宮</td>
                <td class="genjiko-romaji">Nioumiya</td>
                <td class="genjiko-english">Niou</td>
                <td class="genjiko-partition">{1, 2, 4}, {3, 5}</td>
                <td class="genjiko-icon">p</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">43</td>
                <td class="genjiko-kanji">紅梅</td>
                <td class="genjiko-romaji">Kōbai</td>
                <td class="genjiko-english">Kobai</td>
                <td class="genjiko-partition">{1}, {2, 5}, {3}, {4}</td>
                <td class="genjiko-icon">q</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">44</td>
                <td class="genjiko-kanji">竹河</td>
                <td class="genjiko-romaji">Takekawa</td>
                <td class="genjiko-english">Bamboo River</td>
                <td class="genjiko-partition">{1, 5}, {2, 3, 4}</td>
                <td class="genjiko-icon">r</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">45</td>
                <td class="genjiko-kanji">橋姫</td>
                <td class="genjiko-romaji">Hashihime</td>
                <td class="genjiko-english">The Bridge Maiden</td>
                <td class="genjiko-partition">{1, 3, 4, 5}, {2}</td>
                <td class="genjiko-icon">s</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">46</td>
                <td class="genjiko-kanji">椎本</td>
                <td class="genjiko-romaji">Shiigamoto</td>
                <td class="genjiko-english">At the Foot of the Oak-Tree</td>
                <td class="genjiko-partition">{1, 4}, {2, 3}, {5}</td>
                <td class="genjiko-icon">t</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">47</td>
                <td class="genjiko-kanji">総角</td>
                <td class="genjiko-romaji">Agemaki</td>
                <td class="genjiko-english">Agemaki</td>
                <td class="genjiko-partition">{1, 4, 5}, {2, 3}</td>
                <td class="genjiko-icon">u</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">48</td>
                <td class="genjiko-kanji">早蕨</td>
                <td class="genjiko-romaji">Sawarabi</td>
                <td class="genjiko-english">Fern-Shoots</td>
                <td class="genjiko-partition">{1, 2}, {3, 5}, {4}</td>
                <td class="genjiko-icon">v</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">49</td>
                <td class="genjiko-kanji">宿木</td>
                <td class="genjiko-romaji">Yadorigi</td>
                <td class="genjiko-english">The Mistletoe</td>
                <td class="genjiko-partition">{1, 2, 4, 5}, {3}</td>
                <td class="genjiko-icon">w</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">50</td>
                <td class="genjiko-kanji">東屋</td>
                <td class="genjiko-romaji">Azumaya</td>
                <td class="genjiko-english">The Eastern House</td>
                <td class="genjiko-partition">{1, 2, 5}, {3}, {4}</td>
                <td class="genjiko-icon">x</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">51</td>
                <td class="genjiko-kanji">浮舟</td>
                <td class="genjiko-romaji">Ukifune</td>
                <td class="genjiko-english">Ukifune</td>
                <td class="genjiko-partition">{1, 5}, {2, 3}, {4}</td>
                <td class="genjiko-icon">y</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">52</td>
                <td class="genjiko-kanji">蜻蛉</td>
                <td class="genjiko-romaji">Kagerō</td>
                <td class="genjiko-english">The Gossamer-Fly</td>
                <td class="genjiko-partition">{1, 3, 5}, {2, 4}</td>
                <td class="genjiko-icon">z</td>
            </tr>
            
            <tr>
                <td class="genjiko-chapter">53</td>
                <td class="genjiko-kanji">手習</td>
                <td class="genjiko-romaji">Tenarai</td>
                <td class="genjiko-english">Writing-Practice</td>
                <td class="genjiko-partition">{1, 2, 3, 4, 5}</td>
                <td class="genjiko-icon">1</td>
            </tr>
            
        </tbody>
    </table>
</div>

<p>You can download this same table as a <a href="/post/genji-ko_files/genjiko.csv">UTF-8 encoded CSV file</a>
or <a href="/post/genji-ko_files/genjiko.xlsx">Excel spreadsheet</a>.</p>

    </article>

    <hr>


    <ul class="pager article-pager">
      <li class="pager-newer pager-noitem">&lt; Newer</li>
      <li class="pager-older">
        <a href="/post/gpt-cnn/" data-toggle="tooltip" data-placement="top" title="A Picture is Worth 170 Tokens: How Does GPT-4o Encode Images?">Older &gt;</a>
      </li>
    </ul>
  </div>


<div class="site-footer">
  <div class="copyright">
	  &copy; Copyright 2024 Oran Looney
  </div>
  <ul class="site-footer-items">
  </ul>
  <div class="powerdby">
    Powered by <a href="https://gohugo.io/" target="_blank">Hugo</a>
  </div>
</div>
<script src="/js/script.js"></script>
<script src="/js/custom.js"></script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"] ],
    displayMath: [ ["\\[","\\]"] ],  // ['$$','$$'], 
    processEscapes: true,
    processEnvironments: true
  },
  // Center justify equations in code and markdown cells. Elsewhere
  // we use CSS to left justify single line equations in code cells.
  displayAlign: 'center',
  "HTML-CSS": {
    styles: {'.MathJax_Display': {"margin": 0}},
    linebreaks: { automatic: true }
  },
  TeX: { extensions: ["color.js"] }
});
</script>


<link rel="stylesheet"
	href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>
  hljs.configure({
    languages: ['python', 'r', 'javascript']
  })
  hljs.initHighlightingOnLoad()
</script>



</body>
</html>
